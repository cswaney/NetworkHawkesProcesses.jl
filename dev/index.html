<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · NetworkHawkesProcesses.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.png" alt="NetworkHawkesProcesses.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>NetworkHawkesProcesses.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Package-Features"><span>Package Features</span></a></li><li><a class="tocitem" href="#Getting-Started"><span>Getting Started</span></a></li><li><a class="tocitem" href="#Next-Steps"><span>Next Steps</span></a></li></ul></li><li><a class="tocitem" href="tutorial/">Tutorial</a></li><li><a class="tocitem" href="examples/">Examples</a></li><li><a class="tocitem" href="api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cswaney/NetworkHawkesProcesses.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="NetworkHawkesProcesses.jl"><a class="docs-heading-anchor" href="#NetworkHawkesProcesses.jl">NetworkHawkesProcesses.jl</a><a id="NetworkHawkesProcesses.jl-1"></a><a class="docs-heading-anchor-permalink" href="#NetworkHawkesProcesses.jl" title="Permalink"></a></h1><p><code>NetworkHawkesProcess.jl</code> implements a class of probabilistic models that combine multivariate Hawkes processes with network models (<a href="https://dash.harvard.edu/handle/1/33493391">Linderman, 2016</a>). The intensity of such models takes the form</p><p class="math-container">\[\lambda_n(t) = \lambda_n^{(0)}(t) + \sum_n \sum_{\substack{c_i = n,\\ s_i &lt; t}} a_{n \rightarrow &#39;} h_{n \rightarrow n&#39;}(t - s_i \ | \ \theta_{n \rightarrow n&#39;}),\]</p><p>where <span>$a_{n \rightarrow n&#39;}$</span> is a binary variable representing the existence of a directed link from process <span>$n$</span> to process <span>$n&#39;$</span> generated by a process</p><p class="math-container">\[a_{n \rightarrow n&#39;} \sim p(a_{n \rightarrow n&#39;} \ | \ \eta_{n \rightarrow n&#39;})\]</p><p>These models–<strong>network Hawkes processes</strong>–permit simultaneous inference on the structure of a network and its event generating process. The <code>NetworkHawkesProcesses</code> package provides methods to simulate and estimate such processes. It allows researchers to construct models from a flexible set of model components, run inference from a list of compatible methods (including maximum-likelihood estimation, Markov chain Monte Carlo sampling, and variational inference), and explore results with visualization and diagnostic utilities.</p><h2 id="Package-Features"><a class="docs-heading-anchor" href="#Package-Features">Package Features</a><a id="Package-Features-1"></a><a class="docs-heading-anchor-permalink" href="#Package-Features" title="Permalink"></a></h2><ul><li>Supports continuous and discrete processes</li><li>Uses modular design to support extensible components</li><li>Implements simulation via Poisson thinning</li><li>Provides multiple estimation/inference methods</li><li>Supports a wide range of network specifications</li><li>Supports non-homogeneous baselines</li><li>Accelerates methods via Julia&#39;s built-in <code>Threads</code> module</li></ul><h2 id="Getting-Started"><a class="docs-heading-anchor" href="#Getting-Started">Getting Started</a><a id="Getting-Started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started" title="Permalink"></a></h2><h3 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h3><pre><code class="language-julia hljs">julia&gt; using Pkg;
julia&gt; Pkg.add(&quot;https://github.com/cswaney/NetworkHawkesProcesses.jl.git&quot;)
# or pkg&gt; add &quot;https://github.com/cswaney/NetworkHawkesProcesses.jl.git&quot;</code></pre><h3 id="Creating-Processes"><a class="docs-heading-anchor" href="#Creating-Processes">Creating Processes</a><a id="Creating-Processes-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-Processes" title="Permalink"></a></h3><p>Proceses are constructed from a combination of component models. All processes require a <code>Baseline</code> model, and <code>ImpulseResponse</code> model, and a <code>Weights</code> model. For a <code>ContinuousStandardHawkesProces</code>, which does not incorporate network structe, these are all that is needed:</p><pre><code class="language-julia hljs">using NetworkHawkesProcesses

nnodes = 2
weight = 0.1
Δtmax = 1.0

baseline = NetworkHawkesProcesses.HomogeneousProcess(ones(nnodes))
weights = NetworkHawkesProcesses.DenseWeightModel(weight .* ones(nnodes, nnodes))
impulses = NetworkHawkesProcesses.ExponentialImpulseResponse(ones(nnodes, nnodes))
process = NetworkHawkesProcesses.ContinuousStandardHawkesProcess(baseline, impulses, weights)</code></pre><p>A <code>ContinuousNetworkHawkesProces</code> requires a <code>Network</code> model and adjacency matrix as well:</p><pre><code class="language-julia hljs">network = NetworkHawkesProcesses.BernoulliNetworkModel(0.5, nnodes)
links = NetworkHawkesProcesses.rand(network)
process = NetworkHawkesProcesses.ContinuousNetworkHawkesProcess(baseline, impulses, weights, links, network)</code></pre><p>Discrete processes are constructed in a similar fashion, but some component models must be changed to an appropriate discrete version and a time step size is required. For example, here is how to construct a <code>DiscreteStandardHawkesProcess</code>:</p><pre><code class="language-julia hljs">nnodes = 2
nbasis = 3
nlags = 4
weight = 0.1
dt = 1.0

baseline = NetworkHawkesProcesses.DiscreteHomogeneousProcess(ones(nnodes), dt)
weights = NetworkHawkesProcesses.DenseWeightModel(weight .* ones(nnodes, nnodes))
impulses = NetworkHawkesProcesses.DiscreteGaussianImpulseResponse(ones(nnodes, nnodes, nbasis) ./ nbasis, nlags, dt)
process = NetworkHawkesProcesses.DiscreteStandardHawkesProcess(baseline, impulses, weights, dt)</code></pre><p>A <code>DiscreteNetworkHawkesProcess</code> only requires the addition of a <code>Network</code> model and adjacency matrix:</p><pre><code class="language-julia hljs">network = NetworkHawkesProcesses.BernoulliNetworkModel(0.5, nnodes)
links = NetworkHawkesProcesses.rand(network)
process = NetworkHawkesProcesses.DiscreteNetworkHawkesProcess(baseline, impulses, weights, links, network, dt)</code></pre><h3 id="Simulating-Data"><a class="docs-heading-anchor" href="#Simulating-Data">Simulating Data</a><a id="Simulating-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-Data" title="Permalink"></a></h3><p>Following conventional (e.g., <code>Disctributions</code>), <code>NetworkHawkesProcesses</code> defines <code>rand</code> methods for the purpose of simulating data:</p><pre><code class="language-julia hljs">events, nodes, duration = rand(process, 100.0) # typeof(process) == ContinuousHawkesProcess
data = rand(process, 100) # typeof(process) == DiscreteHawkesProcess</code></pre><p>Generally, the simulation <code>duration</code> is any positive value, but some baselines (e.g., <code>LogGaussianCoxProcess</code>) define a maximum duration.</p><p>Note that the format of simulated data is quite different for continuous and discrete processes. For continuous processes, simulation returns separate arrays of event times and nodes, in addition to the simulation duration. For discrete processes, simulated data is represented as a matrix whose rows contain event counts for each node, with each column representing a time step.</p><pre><code class="language-julia hljs">size(data) # (2, 100)</code></pre><h3 id="Running-Inference"><a class="docs-heading-anchor" href="#Running-Inference">Running Inference</a><a id="Running-Inference-1"></a><a class="docs-heading-anchor-permalink" href="#Running-Inference" title="Permalink"></a></h3><p>The package provides several method for performing inference, including maximum-likelihood estimation (<code>mle!</code>), Markov Chain Monte Carlo sampling (<code>mcmc!</code>), and variational inference (<code>vb!</code>, <code>svi!</code>).</p><pre><code class="language-julia hljs">res = NetworkHawkesProcesses.mle!(process, data; verbose=true, regularize=true) # maximum a posteriori</code></pre><p>The inference methods available depend on the type of model (see the table below). Processes with <code>Network</code> models don&#39;t provide maximum-likelihood estimation due to the presence on binary parameters in the adjacency matrix; and only discrete processes provide variational inference methods.</p><table><tr><th style="text-align: right">Model</th><th style="text-align: right">Available Methods</th></tr><tr><td style="text-align: right"><code>ContinuousStandardHawkesProcess</code></td><td style="text-align: right"><code>mle!</code>, <code>mcmc!</code></td></tr><tr><td style="text-align: right"><code>ContinuousNetworkHawkesProcess</code></td><td style="text-align: right"><code>mcmc!</code></td></tr><tr><td style="text-align: right"><code>DiscreteStandardHawkesProcess</code></td><td style="text-align: right"><code>mle!</code>, <code>mcmc!</code>, <code>vb!</code>, <code>svi!</code></td></tr><tr><td style="text-align: right"><code>DiscreteNetworkHawkesProcess</code></td><td style="text-align: right"><code>mcmc!</code>, <code>vb!</code>, <code>svi!</code></td></tr></table><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>All inference methods overwrite model parameters. In addition, each method takes a default initial guess at the model parameters if no initial guess is provided.</p></div></div><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>A fast option for an initial guess is to estimate a homogenous Poisson process (although this doesn&#39;t provide any guidance for impulse response, network, or connection parameters).</p></div></div><h3 id="Reporting-Diagnostics"><a class="docs-heading-anchor" href="#Reporting-Diagnostics">Reporting Diagnostics</a><a id="Reporting-Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Reporting-Diagnostics" title="Permalink"></a></h3><p>The package provides several methods to examine models and simulated data.</p><ul><li><code>isstable(processs)</code> checks the stability of a Hawkes process. Unstable processes will often fail to generate finite data samples.</li><li><code>intensity(process, data, times)</code> calculates the intensity of a process (given <code>data</code>) for all times in <code>times</code>.</li><li><code>loglikelihood(process, data)</code> calculates the log-likelihood of a dataset.</li></ul><h3 id="multi-threading"><a class="docs-heading-anchor" href="#multi-threading">multi-threading</a><a id="multi-threading-1"></a><a class="docs-heading-anchor-permalink" href="#multi-threading" title="Permalink"></a></h3><p>Several methods use multi-threading to speed up computation. For all such methods, multi-threading is automatically activated and uses as many threads as available to the Julia process. For example, to use all local CPU threads (i.e., &quot;logical cores&quot;), start the Julia session with <code>julia --threads auto</code>.</p><h2 id="Next-Steps"><a class="docs-heading-anchor" href="#Next-Steps">Next Steps</a><a id="Next-Steps-1"></a><a class="docs-heading-anchor-permalink" href="#Next-Steps" title="Permalink"></a></h2><p>Check out our tutorials and examples to learn more about how the package works and see practical examples of its usage, or browse our API documentation for detailed information on package components.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="tutorial/">Tutorial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 9 February 2023 01:01">Thursday 9 February 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
